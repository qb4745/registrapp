"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[4773],{4773:(Z,h,i)=>{i.r(h),i.d(h,{LoginPage:()=>I});var u=i(5861),m=i(6814),s=i(95),n=i(6196),f=i(9862),e=i(6689),v=i(2333),y=i(8828),P=i(5266),b=i(2518);function T(l,d){1&l&&(e.TgZ(0,"ion-note",17),e._uU(1,"Ingresa tu correo electr\xf3nico"),e.qZA())}function E(l,d){1&l&&(e.TgZ(0,"ion-note",17),e._uU(1,"Ingresa tu contrase\xf1a"),e.qZA())}let I=(()=>{var l;class d{constructor(t,r,o,a,c,_,g){this.fb=t,this.authService=r,this.loadingController=o,this.alertController=a,this.router=c,this.alumnoService=_,this.profesorService=g,this.rol=2,this.credentials=this.fb.group({email:["",s.kI.required],password:["",s.kI.required]})}ngOnInit(){this.authService.getCurrentUser().subscribe(t=>{t&&(this.userId=this.authService.getCurrentUserId(),this.alumnoService.getAlumnoInfo(this.userId).subscribe(r=>{r&&!1===this.authService.initialized&&this.redirectByRolValue(r[0].rol)}),this.profesorService.getProfesorInfo(this.userId).subscribe(r=>{r&&!1===this.authService.initialized&&this.redirectByRolValue(r[0].rol)}))}),this.credentials.get("email").setValue("combustion.2@gmail.com"),this.credentials.get("password").setValue("123456")}ionViewWillEnter(){return(0,u.Z)(function*(){})()}get email(){return this.credentials.controls.email}get password(){return this.credentials.controls.password}login(){var t=this;return(0,u.Z)(function*(){const r=yield t.loadingController.create();yield r.present(),t.authService.signIn(t.credentials.getRawValue()).then(function(){var o=(0,u.Z)(function*(a){yield r.dismiss(),a.error&&t.showAlert("Inicio de sesi\xf3n fallido",a.error.message)});return function(a){return o.apply(this,arguments)}}())})()}forgotPw(){var t=this;return(0,u.Z)(function*(){var o;yield(yield t.alertController.create({header:"Recibir una nueva contrase\xf1a",message:"Por favor, ingresa tu correo electr\xf3nico",inputs:[{type:"email",name:"email"}],buttons:[{text:"Cancelar",role:"cancel"},{text:"Restablecer contrase\xf1a",handler:(o=(0,u.Z)(function*(a){const c=yield t.loadingController.create();yield c.present();const{error:g}=yield t.authService.sendPwReset(a.email);yield c.dismiss(),g?t.showAlert("Error","Por favor, ingresa tu correo electr\xf3nico"):t.showAlert("\xc9xito","\xa1Por favor, revisa tu correo electr\xf3nico para obtener m\xe1s instrucciones!")}),function(c){return o.apply(this,arguments)})}]})).present()})()}getMagicLink(){var t=this;return(0,u.Z)(function*(){var o;yield(yield t.alertController.create({header:"Obtener un Enlace M\xe1gico",message:"\xa1Te enviaremos un enlace para iniciar sesi\xf3n de manera m\xe1gica!",inputs:[{type:"email",name:"email"}],buttons:[{text:"Cancelar",role:"cancel"},{text:"Obtener Enlace M\xe1gico",handler:(o=(0,u.Z)(function*(a){const c=yield t.loadingController.create();yield c.present();const{data:_,error:g}=yield t.authService.signInWithEmail(a.email);yield c.dismiss(),console.log("despu\xe9s de registrarse: ",_),console.log("error despu\xe9s de registrarse: ",g),g?t.showAlert("Error",g.message):t.showAlert("\xc9xito","\xa1Por favor, revisa tu correo electr\xf3nico para obtener m\xe1s instrucciones!")}),function(c){return o.apply(this,arguments)})}]})).present()})()}showAlert(t,r){var o=this;return(0,u.Z)(function*(){yield(yield o.alertController.create({header:t,message:r,buttons:["OK"]})).present()})()}redirectByRolValue(t){1===t?this.goToStudentTabs():2===t&&this.goToTeacherTabs(),this.authService.setInizializedToTrue()}goToStudentTabs(){this.authService.initialized||this.router.navigate(["student","tabs","tab1"])}goToTeacherTabs(){this.router.navigate(["teacher","tabs","tab1"])}goToRegister(){this.router.navigate(["register"])}}return(l=d).\u0275fac=function(t){return new(t||l)(e.Y36(s.qu),e.Y36(v.e),e.Y36(n.HT),e.Y36(n.Br),e.Y36(y.F0),e.Y36(P.X),e.Y36(b._))},l.\u0275cmp=e.Xpm({type:l,selectors:[["app-login"]],standalone:!0,features:[e.jDz],decls:32,vars:4,consts:[["color","primary"],["size","auto"],["src","assets/logo.png","alt","Logo","width","24","height","24"],["color","light",1,"centered-title"],["scrollY","false"],[1,"animate__animated","animate__fadeInUp"],[3,"formGroup","ngSubmit"],["position","stacked"],["type","email","inputmode","email","placeholder","Ingresa tu correo electr\xf3nico","formControlName","email"],["slot","error",4,"ngIf"],["type","password","placeholder","Ingresa tu contrase\xf1a","formControlName","password"],["type","submit","expand","block","strong","true",3,"disabled"],[1,"ion-margin-top"],["type","button","expand","block","color","secondary",3,"click"],["name","key-outline","slot","start"],["type","button","expand","block","color","tertiary",3,"click"],["name","mail-outline","slot","start"],["slot","error"]],template:function(t,r){1&t&&(e.TgZ(0,"ion-header")(1,"ion-toolbar",0)(2,"ion-grid")(3,"ion-row")(4,"ion-col",1),e._UZ(5,"img",2),e.qZA(),e.TgZ(6,"ion-col")(7,"ion-title",3),e._uU(8," RegistrAPP "),e.qZA()()()()()(),e.TgZ(9,"ion-content",4)(10,"ion-card",5)(11,"ion-card-content")(12,"form",6),e.NdJ("ngSubmit",function(){return r.login()}),e.TgZ(13,"ion-item")(14,"ion-label",7),e._uU(15,"Correo electr\xf3nico"),e.qZA(),e._UZ(16,"ion-input",8),e.YNc(17,T,2,0,"ion-note",9),e.qZA(),e.TgZ(18,"ion-item")(19,"ion-label",7),e._uU(20,"Contrase\xf1a"),e.qZA(),e._UZ(21,"ion-input",10),e.YNc(22,E,2,0,"ion-note",9),e.qZA(),e.TgZ(23,"ion-button",11),e._uU(24,"Ingresar"),e.qZA(),e.TgZ(25,"div",12)(26,"ion-button",13),e.NdJ("click",function(){return r.forgotPw()}),e._UZ(27,"ion-icon",14),e._uU(28," \xbfOlvidaste tu contrase\xf1a? "),e.qZA(),e.TgZ(29,"ion-button",15),e.NdJ("click",function(){return r.getMagicLink()}),e._UZ(30,"ion-icon",16),e._uU(31," Ingresa con Email "),e.qZA()()()()()()),2&t&&(e.xp6(12),e.Q6J("formGroup",r.credentials),e.xp6(5),e.Q6J("ngIf",(r.email.dirty||r.email.touched)&&r.email.errors),e.xp6(5),e.Q6J("ngIf",(r.password.dirty||r.password.touched)&&r.password.errors),e.xp6(1),e.Q6J("disabled",!r.credentials.valid))},dependencies:[n.Pc,n.YG,n.PM,n.FN,n.wI,n.W2,n.jY,n.Gu,n.gu,n.pK,n.Ie,n.Q$,n.uN,n.Nd,n.wd,n.sr,n.j9,m.ez,m.O5,s.u5,s._Y,s.JJ,s.JL,s.UX,s.sg,s.u,f.JF],styles:["ion-content[_ngcontent-%COMP%]{--padding-top: 20%;--padding-start: 5%;--padding-end: 5%;height:100%;width:100%;--background: linear-gradient(rgba(0, 0, 0, .6), rgba(0, 0, 0, .7)), url(https://images.unsplash.com/photo-1544640808-32ca72ac7f37?auto=format&fit=crop&q=80&w=1635&ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D) no-repeat center;background-size:cover}.titulo-centrado[_ngcontent-%COMP%]{text-align:center;margin:0 auto;display:flex;justify-content:center;align-items:center}.centered-title[_ngcontent-%COMP%]{text-align:center;width:90%;align-items:center;margin:0 auto;display:flex;justify-content:center}"]}),d})()}}]);